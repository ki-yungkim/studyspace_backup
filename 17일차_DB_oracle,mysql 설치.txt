#########################
	17일차 데이터 베이스
#########################
-----------------------
포트폴리오 중요하다

알고리즘 STEP 1 진행 해두기 
알고리즘은 회사에서 매우 중요하다 
-----------------------
-- 데이터는 무엇인가? 
	> 자료
	> FACT
	
-- 정보 (information)
	>> data 가공
		데이터를 가공해서 산출되는 것
	>> 의사결정
	내가 필요한 데이터를 잘 가져와야 한다	

-- 데이터 베이스 ?
	> 데이터들이 모여있는 곳
	> data 저장소 (영속성) 

	데이터 아무나 접근 하면 안된다
	데이터 관리하는 시스템이 필요하다

-- DBMS (Database management system)
	>> 계층형(HDBMS)
	>> 네트워크형 (NDBMS)
	>> 관계형 (RDBMS)
	>> 객체관계형 (ORDBMS)

	데이터 - 데이터 관계 맺고 있는게 사용하기 편하다  
-- 관계형 (RDBMS)
	>> Oracle, DB2, MSSQL, MySQL, ...
		
	데이터를 access 하기 위한 표준화가 필요하다

-- SQL (Structure Query Language)
	>> ANSI 표준 (미국)
	>> RDBMS 
	>> 분류 : DDL, DML(DQL), DCL, TCL
	>> DAO(Data Access Object) : Table, View, Sequence, Index, Trigger 등 
								> 오브젝트 들
	>> DDL : 객체 생성(create), 변경(alter), 삭제(drop) (CRUD에 관련)
	>> DML(DQL) : 레코드 추가 (insert), 조회(select), 변경(update), 삭제(delete) 
	>> DQL : 조회(select) - 따로 빼서 구별 하는 경우도 있다 
	
	>> DCL (데이터 베이스 control): 사용자 생성, 변경, 삭제, 권한 부여, 제거 데이터베이스 관리
	>> TCL : 트랜잭션 제어 (계좌이체(송금): a계좌 100만원 출금 => b계좌 100만원 입금)
						> 영속적 반영, 롤백 (오류 생겨서 돈 못 들어가면 돌려주기, 입금 완료되면 한쪽 -100, 한쪽 +100 처리)
	
-- DB 관련 자격증
	>> 국내
	>> 정보처리기사 (공공기관 개발 필수) => (4년 필요) 기술사 
		>> DB 내용이 있음
	>> https://www.dataq.or.kr/www/main.do :SQLD/SQLP, ADSP/ADP, ...
											(Oracle/MSSQL)
	>> 국제 
	>> Oracle : OCP, OCM
	 
	 
## mysql download
-- https://www.mysql.com/
-- Enterprise Edition (라이센스)
-- Community Edition (학습용)

MySQL Community (GPL) Downloads

MySQL Installer for Windows

첫번째는 web-community 
두번째는 그냥 community  -- 이것 설치

아래에 No thanks, just start my download.

archives 누르면 예전 버전 받을 수 있다.

지금은 8.0.25 버전 사용 

## oracle download

-- https://www.oracle.com/downloads/
-- Enterprise Edition(라이센스)
-- Express Edition(학습용)

-- oracle 버전
	>> 8i, 9i
	>> 10g, 11g (실무에서 많이 사용, 설치할 버전) 
	>> 12c.. 18c
	
Database - Database 19c Enterprise/Standard Editions 
- 아래 쪽으로 쭉 내려가서 
- Oracle Database Express Edition 
- Oracle Database 11g Release 2 Express Edition for Windows 64
- Oracle Database 11gR2 Express Edition for Windows x64
- 로그인 하고 다운로드

## mysql 설치
책에 설치 순서 나와있으니 그거 보고 따라 해도 된다
커스텀으로 원하는 것만 해도 된다.
이번 강의에선 default로 
default - next (visual 도 설치) - execute 

port 같은 건 그대로 

recommanded

루트 계정 암호 입력하는 것 있다
쓰는 암호 있으면 그냥 쓰고
강사님이 쓰는 암호 mysql root 계정 암호 : admin1004

add user 
유저 만들건지 물어보는 곳 
add user name : scott
add user pw : tiger

next

execute

samples and examples 

아이디 root
비밀번호 admin1004

finish

-------------
실행 해보기 


윈도우 시작메뉴 - mysql 폴더 생성된 것 확인

실행 파일 위치 : c - programfiles -  mysql - C:\Program Files\MySQL\MySQL Server 8.0\bin - mysql.exe

제어판 - 시스템 - 고급시스템 - 환경변수 - path -  bin 폴더 패스 추가 

cmd -> mysql -u root -padmin1004
비밀번호 숨기려면  mysql -u root -p 치고 엔터 치고 비밀번호 입력



## 프로그램 설치 
	>> 기본폴더 : 64bit C\Program Files\프로그램명
	>> 기본폴더 : 32bit C\Program Files(x86)\프로그램명
	
## 프로그램 실행
	>> 아이콘 클릭
	
	>> 명령창 > 입력실행.exe / 실행.bat => 환경설정 path 기반 순서대로 검색 실행 
	>> 오류발생 
		내부 또는 외부 명령, 실행할 수 있는 프로그램, 또는 배치 파일  
		1. 해당 파일이 존재하지 않음
		2. path 설정 안되어있음 => 제어판 > 시스템 > 고급설정 > path 추가 => 명령창 재구동
		
## mysql
1. 서버 계정 접속
	dos> mysql -u 아이디 -p비밀번호
	dos> mysql -u 아이디 -p
	Enter Password : 비밀번호
	
	mysql>
	
	이렇게 로그인 해도 된다 
	C:\Users\kky>mysql -u scott -ptiger
		(계정 추가해놨음)

	
2. database 생성	

	mysql > create database mms_db default character set utf8;

	상태 확인 
	status; 

3. 사용할 database 설정 
	mysql> use mms_db;
	
4. 현재 계정의 테이블 목록 조회 
	show tables;


## 사용자 계정 생성 
-- root 권한 : root 계정 접속 (mysql -u root -padmin1004)
dos > mysql -u root -p 

-- 사용자 계정 삭제 
drop user scott@localhost;

-- 사용자 계정 생성
create user scott@localhost identified by 'tiger';

-- 사용자 권한 부여 
grant all privileges on *.* to scott@localhost;   
> 모든 권한 부여 - 루트 권한 급	


 ERROR 1064 (42000): You have an error in your SQL syntax ~~
 > 이건 오타 문제, 명령어 잘 쳤는지 확인 
 
 
참고: MYSQL Command line Client 쓰면 아에 루트 계정으로 들어간다.
	Cmd로 들어가면 다양한 유저 사용 가능  
 

## 테이블 확인 

show tables

> ERROR : No database selected
> 어떤 데이터 베이스 쓸 건지 설정 해줘야 한다.

use mms_db;

show tables; 다시 


## mysql server 
1. cui : 명령창>
2. gui : workbench 
	(workbench 설치는 선택 사항이다) 
	
	+ 선택 
	connection name : 보통 계정이름이랑 똑같이 (보여지는 이름)
	현재 시스템의 ip : 127.0.0.1 로컬호스트
	기본 포트 3306
	username : 진짜 아이디 틀리면 안됨
	test connection : 비밀번호 입력 - 체크박스 - 내 자리면 save, 아니면 체크하면 안됨 
	> succesfully~~
	
	Default Schema : 디폴트 데이터베이스 이름 
	
	계정 추가 됨
	
	더블클릭 실행 
	
	쿼리 창 
	> use mms_db; 
	> ctrl 엔터 

	> 아래에 성공 여부 뜸 
	
	
##	
SQL 스크립트 파일 
자바에서 bat 파일처럼 
수행해야할 sql 구문 	
	
	
DROP TABLE > 테이블 삭제 
	
open sql 스크립트 메뉴로 mysql_scott 파일 오픈 

번개 모양 눌러서 실행 


Query1으로 다시 

>> 주석
-- sql 한줄 주석
/* sql 여러줄 주석 */

-- 테이블 목록 조회
>> show tables;

-- 테이블 구조(table schema) 조회 : desc 테이블명;
-- 부서 테이블 : dept
-- 직원 테이블 : emp
-- 급여등급 테이블 : salgrade

-- 테이블 레코드 조회 : select * from 테이블명;

	-- 전체 부서정보 조회 
	select * from dept;
	-- 전체 직원 정보 조회
	select * from emp;
	-- 전체 급여등급 정보 조회
	select * from salgrade;
	
	
	
#DROP TABLE IF EXISTS EMP;

	IF EXIST 이런 것은 오라클에는 없다


# 관계를 맺었을 때 삭제 
그냥 하면 에러 남 
-- 직원 테이블 삭제 : drop table 테이블명;
	drop table dept;

===================================================	


## 강사님의 노트북 처음 받았을 때 셋업 방식 
-- 드라이브 3개 분리
-- C: 프로그램 설치 드라이브
-- D: 업무 데이터 드라이브 
-- E: 백업 드라이브 (살짝 개인) 

## 강사님의 새 노트북 프로그램 설치 
-- 셋업해서 인터넷 연결 확인 후 
1. 오라클 제일 우선 설치 
2. 시스템 재부팅  
=================================

## oracle 설치 
-- 유의사항 계정명 영문, 공백불가 
-- c:\드라이브 기본 폴더 설치 
-- 설치 후 오라클 path 자동 추가 : 맨 앞에 추가 시켜 줌 

- 압축 해제 
- setup.exe 실행	
- next 
- 라이센스 동의 next 
- 설치 폴더 기본으로 

- 관리자 계정 -> System  (mysql은 root)
- password admin1004

- install 

- 한번에 잘 깔리길 기도

Finish 

설치 폴더 찾아가보기 : C:\oraclexe

cmd 
 	
오라클이 path 맨 앞에 있는데 오라클 안에 자바 환경이 있어서 
자바 실행할 때 문제 생기기도 한다 

## oracle server 
1. cui : 명령창 > sqlplus id/pw 
2. gui : SQLDeveloper(oracle 제공), toad(상용), orange(상용).. gui는 많다 

sqlplus id 치고 엔터 - 비밀번호 입력 
sqlplus id/pw 한번에 입력도 가능 

## SQL*Plus 명령어 (SQL*Plus라는 앱에서만 쓸 수 있다) 
	> 콘솔창이 떠 있는 동안만 적용
-- show 
	설정 확인 
	
-- show all 
	환경 설정 전체
	linesize 80 : 라인 크기 
	pagesize 14 : 페이지 크기 
	
>> 설정 
-- set linesize 300 
-- set pagesize 300 

>> 화면 지우기  
-- cl scr 

	; 있어도 되고 없어도 된다.

-- 종료 : exit / quit 


-- 연결해제 : discon

-- show user : 연결 계정 사용자 아이디 조회

-- 재연결 : conn id/pw	

## 오라클 설치 기본 사용자 계정명 
-- sys : 관리자 계정 
-- system : 관리자 계정 ( 설치시 비밀번호 입력 )
-- hr : 10g 테스트를 위한 사용자 계정 (계정 잠금) 
-- scott/tiger :8i, 9i (계정 사용가능) => 보안 이슈 발생 문제 

## 오라클 사용자 계정 생성, 변경, 권한 : DCL 
--system 계정 연결 



## SQL 구문 명령어  
	> ; 꼭 있어야 한다. 

-- 계정 잠금 해제 : hr 계정  
	> alter user hr account unlock; 

-- 계정 암호 변경 
	> alter user hr identified by tiger;
	
-- discon 하고 conn hr/tiger 

관리자 계정으로 하면 DB가 망가지는 경우가 있다 

-- show user로 계정 HR인지 확인 

-- 전체 테이블 목록 조회
	> select * from tab;

-- 테이블 구조 (스키마) 조회

-- 부서 : DEPARTMENTS
-- 직원 : EMPLOYEES

-- desc DEPARTMENTS;
-- desc EMPLOYEE;

cmd 우클릭 -> 복사 

모든 컬럼명은 대문자로 되어있다  

discon 
con system/admin1004

-- 계정 생성
create user scott identified by tiger;

-- 권한 부여 
grant connect, resource, create view to scott;

-- 계정 삭제 
drop user scott 
> 이렇게만 하면 오류 
> drops user scott cascade; => scott과 관련된 것들 모두 삭제 

-- 계정 잠금 
drop user hr account lock;


## demo schema 
-- scott 
>> scott.sql 
>> C:\oraclexe\app\oracle\product\11.2.0\server\rdbms\admin

-- hr 계정
>> C:\oraclexe\app\oracle\product\11.2.0\server\demo\schema\human_resources


에디터에서 열기 

REM -> remark 주석 
24번 줄부터 4개 rem 처리 
rem GRANT CONNECT,RESOURCE,UNLIMITED TABLESPACE TO SCOTT IDENTIFIED BY TIGER;
rem ALTER USER SCOTT DEFAULT TABLESPACE USERS;
rem ALTER USER SCOTT TEMPORARY TABLESPACE TEMP;
rem CONNECT SCOTT/TIGER


## SQL 스크립트 파일 실행 방법 
exit 
cd C:\00.pratice\02.sql

sqlplus scott/tiger

-- 절대경로 지정
	SQL> start c:\dir\dir\script-file.sql  (절대 경로)

-- 상대경로 : 현재폴더 (sql-plus 구동한 콘솔창 폴더)
	SQL> start script-file.sql (상대경로 (현재 폴더))
	SQL> @script-file.sql


 실행 후 
 select * from tab;
 desc DEPT;
 
 등으로 확인 
 
 -- help spool
 결과 저장 가능 
 폴더 지정 안 하면 현 위치
 SPO[OL] [file_name[.ext] [CRE[ATE] | REP[LACE] | APP[END]] | OFF | OUT]
 
 spool 210610_select.sql
 spool off 
 
 시작부터 off 사이에 있는 것들이 파일에 저장됨 
	
	연결 종료나 sqlplus 종료 시에도 출력 

## SQL 구문
-- 대소문자 구분하지 않음
	>> 기본적으로 DB에서 자동으로 대문자 식별자(테이블명, 컬러명, 제약명 등) 처리
	>> 길이 제한 : 30자리 
	>> 모두대문자_모두대문자 
	>> 예약어 식별자 사용불가 

## 데이터 타입 
-- 숫자 
	>> 정수 number, number(길이) (길이 지정 안 하면 최대한의 길이)
	>> 실수 number(전체길이, 소수이하길이) 
	
-- 문자열
	>> 고정문자열 char(길이)
	>> 가변문자열 varchar2(길이) ex) 자소서 2000자 이내 
	
	
-- 날짜 
	>> 문자열 : 날짜형식고정, 날짜연산수행하지 않는 경우
	>> 날짜 타입 date 
		=> 날짜형식가변, 날짜연산 수행경우 => 게시글 오늘 글은 시간만, 어제 글은 날짜 시간 이런 경우 
		=> 길이 지정하지 않음  
		=> 날짜, 시간 


## 데이터 표현
-- 문자, 날짜 : '문자열', '2016-06-10'
-- 숫자 : 1234,123,5678
-- 별명(ALIAS) : 테이블, 컬럼에 대한 별명지정 "별명"


Name                    Null?    Type
 ----------------------- -------- ----------------
 EMPNO                   NOT NULL NUMBER(4)
 ENAME                            VARCHAR2(10)
 JOB                              VARCHAR2(9)
 MGR                              NUMBER(4)
 HIREDATE                         DATE
 SAL                              NUMBER(7,2)
 COMM                             NUMBER(7,2)
 DEPTNO                           NUMBER(2)
	
	
## DML(DQL) : C 레코드 추가 (insert), R조회 (select), U변경(update), D삭제(delete)

## DQL : 조회 (select)
1. 필수형식
SELECT * | 컬럼명1, 컬럼명X | 컬럼명1 "별명", 컬럼명X "별명"  (* 는 모든 컬럼) 
		| 수식 | 함수명() | (SUB-QUERY)
FROM 테이블명;
		
	> SELECT EMPNO, ENAME, SAL FROM EMP;
	> SELECT EMPNO "사번" , ENAME "이름" , SAL "급여"  FROM EMP;
	> select 5 * 3 + 10 FROM DUAL;
-- 컬럼 별명 : 
	>> "대소문자 구분"
	>> "공백 가능"
	>> "특수문자"
	
	>> 별명 "" 생략가능 :  대문자, 공백없고, 특수문자 없는 경우	
	
	> SELECT EMPNO "Employee No" , ENAME "Name" , SAL "Salary"  FROM EMP;
	> SELECT EMPNO EmployNo , ENAME Name , SAL Salary  FROM EMP;

-- DUAL 테이블 
	>> 오라클 SELECT 필수형식을 위한 DUMMY 테이블 
	>> 연산식 테스트, 함수 테스트 등 
	
2. 전체형식

SELECT ~~
FROM 테이블명 1 [, 테이블명X, (SUB-QUERY) ]
WHERE 조건식1 [AND | OR | NOT ] 조건식 X 
GROUP BY 그룹핑 대상 컬럼명 [, 그룹핑대상컬럼명X] 
HAVING 그룹핑결과에대한조건식
ORDER BY 정렬컬럼명 정렬방법, 정렬컬럼명X 정렬방법
;

-- 정렬항목 : 컬럼명, SELECT 항목에 대한 인덱스 번호, 별명, 수식 
-- 정렬방법 : 올림차순(ASC, 기본), 내림차순 (DESC)
-- 정렬기준 : 
	>> 숫자, 날짜 (작은 것 => 큰 것, 1900, 1901, 1902 ...  ) 
	>> 영문 : ABC...
	>> 한글 : 가나다...
	최근 입사자 조회하려면 DESC 
 
